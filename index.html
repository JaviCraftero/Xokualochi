<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport"
            content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content />
        <meta
            name="Jessica Mariana Monroy Mejía y Javier Enrique Hernández Beltrán"
            content />
        <title>Monitoreo de ranas</title>
        <link
            href="https://cdn.jsdelivr.net/npm/simple-datatables@7.1.2/dist/style.min.css"
            rel="stylesheet" />
        <link href="css/styles.css" rel="stylesheet" />
        <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js"
            crossorigin="anonymous"></script>
        <link rel="apple-touch-icon" sizes="180x180"
            href="assets/img/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32"
            href="assets/img/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16"
            href="assets/img/favicon-16x16.png">
        <link rel="manifest" href="assets/img/site.webmanifest">
        <script type="module">
            // Import the functions from firebase
            import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
            import { getDatabase, ref as dbRef, onValue, set, push, get } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";
            import { getStorage, ref as storageRef, getDownloadURL } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-storage.js";

            const firebaseConfig = {
            apiKey: "AIzaSyCWthF7mN1h1n99IbFAarl-iyVTiwzYm94",
            authDomain: "ranitas-test.firebaseapp.com",
            databaseURL: "https://ranitas-test-default-rtdb.firebaseio.com",
            projectId: "ranitas-test",
            storageBucket: "ranitas-test.firebasestorage.app",  
            messagingSenderId: "1083017529444",
            appId: "1:1083017529444:web:8e246c28345b89172d7771"
            };

            const app = initializeApp(firebaseConfig);
            const db = getDatabase(app);
            const storage = getStorage(app);
            const historialRef = dbRef(db, 'historial');
            const cascadaRef = dbRef(db, 'CasStatus/cascada');
            const dataRef1 = dbRef(db, 'Incu1');
            const dataRef2 = dbRef(db, 'Incu2');
            const dataRef3 = dbRef(db, 'Incu3');  // Nueva referencia para Incubadora 3
            
            // Referencias a las imágenes
            const imageRef1 = storageRef(storage, 'Incubadora_1/foto.jpg');
            const imageRef2 = storageRef(storage, 'Incubadora_2/foto.jpg');
            const imageRef3 = storageRef(storage, 'Incubadora_3/foto.jpg');  // Nueva referencia para Incubadora 3
            
            let cascadaState = "OFF";
            let lastSaveTime = 0;
            const SAVE_INTERVAL = 30*60*1000;

            // Función para actualizar las tres imágenes
            async function updateImages() {
                try {
                    // Actualizar imagen de Incubadora 1
                    const url1 = await getDownloadURL(imageRef1);
                    const img1 = document.getElementById('Incubadora_1');
                    img1.src = url1;

                    // Actualizar imagen de Incubadora 2
                    const url2 = await getDownloadURL(imageRef2);
                    const img2 = document.getElementById('Incubadora_2');
                    img2.src = url2;

                    // Actualizar imagen de Incubadora 3
                    const url3 = await getDownloadURL(imageRef3);
                    const img3 = document.getElementById('Incubadora_3');
                    img3.src = url3;
                } catch (error) {
                    console.error('Error al actualizar imágenes:', error);
                }
            }

            // Escuchar el estado actual desde Firebase
            onValue(cascadaRef, (snapshot) => {
                cascadaState = snapshot.val() || "OFF"; // Si no existe, inicializa como "OFF"
                const button = document.getElementById('toggleCascada');
                button.innerText = cascadaState === "ON" ? "Desactivar Cascada" : "Activar Cascada";
            });

            // Escucha cambios en la base de datos
            onValue(dataRef1, (snapshot) => {
                const data = snapshot.val();
                document.getElementById('DS18').innerText = data.DS18;
                document.getElementById('Temp1').innerText = data.Temp1;
                document.getElementById('Temp2').innerText = data.Temp2;
                document.getElementById('Temp3').innerText = data.Temp3;
                document.getElementById('Hum1').innerText = data.Hum1;
                document.getElementById('Hum2').innerText = data.Hum2;
                document.getElementById('Hum3').innerText = data.Hum3;
                document.getElementById('PromT').innerText = data.PromT;
                document.getElementById('PromH').innerText = data.PromH;
                document.getElementById('pH').innerText = data.pH;

                // Actualizar notificaciones
                updateNotifications(data);

                const currentTime = Date.now();
                if (currentTime - lastSaveTime >= SAVE_INTERVAL) {
                    // Guardar en historial
                    const registro = {
                        ...data,
                        timestamp: new Date().toISOString()
                    };
                    push(historialRef, registro)
                        .then(() => {
                            console.log('Datos guardados en historial');
                            lastSaveTime = currentTime; // Actualizar el tiempo de la última guardada
                            // Actualizar el gráfico después de guardar nuevos datos
                            updateAreaChartWithLatestData();
                        })
                        .catch(error => {
                            console.error('Error al guardar en historial:', error);
                        });
                }
            });

            // Listener para Incu2
            onValue(dataRef2, (snapshot) => {
                const data = snapshot.val();
                document.getElementById('DS18_2').innerText = data.DS18;
                document.getElementById('Temp1_2').innerText = data.Temp1;
                document.getElementById('Temp2_2').innerText = data.Temp2;
                document.getElementById('Temp3_2').innerText = data.Temp3;
                document.getElementById('Hum1_2').innerText = data.Hum1;
                document.getElementById('Hum2_2').innerText = data.Hum2;
                document.getElementById('Hum3_2').innerText = data.Hum3;
                document.getElementById('PromT_2').innerText = data.PromT;
                document.getElementById('PromH_2').innerText = data.PromH;
            });

            // Escuchar cambios en la base de datos para Incubadora 3
            onValue(dataRef3, (snapshot) => {
                const data = snapshot.val();
                document.getElementById('DS18_3').innerText = data.DS18;
                document.getElementById('Temp1_3').innerText = data.Temp1;
                document.getElementById('Temp2_3').innerText = data.Temp2;
                document.getElementById('Temp3_3').innerText = data.Temp3;
                document.getElementById('Hum1_3').innerText = data.Hum1;
                document.getElementById('Hum2_3').innerText = data.Hum2;
                document.getElementById('Hum3_3').innerText = data.Hum3;
                document.getElementById('PromT_3').innerText = data.PromT;
                document.getElementById('PromH_3').innerText = data.PromH;
            });

            async function generateCSV(data) {
                const headers = ["DS18", "Temp1", "Temp2", "Temp3", "Hum1", "Hum2", "Hum3", "PromT", "PromH", "pH", "timestamp"];
                const rows = [headers.join(",")];

                const snapshot = await get(historialRef);
                if (snapshot.exists()) {
                    const historial = snapshot.val();
                    
                    // Arrays para almacenar los datos del gráfico
                    const timestamps = [];
                    const temperatures = [];
                    const humidities = [];

                    Object.values(historial).forEach(reading => {
                        const row = [
                            reading.DS18 || 0,
                            reading.Temp1 || 0,
                            reading.Temp2 || 0,
                            reading.Temp3 || 0,
                            reading.Hum1 || 0,
                            reading.Hum2 || 0,
                            reading.Hum3 || 0,
                            reading.PromT || 0,
                            reading.PromH || 0,
                            reading.pH || 0,
                            reading.timestamp
                        ];
                        rows.push(row.join(","));

                        // Agregar datos para el gráfico
                        timestamps.push(new Date(reading.timestamp).toLocaleTimeString());
                        temperatures.push(reading.PromT || 0);
                        humidities.push(reading.PromH || 0);
                    });

                    // Actualizar el gráfico con los nuevos datos
                    updateAreaChart(timestamps, temperatures, humidities);
                }

                return rows.join("\n");
            }

            function downloadCSV(data) {
                const csvContent = generateCSV(data);

                // Crea un enlace para descargar el archivo
                const blob = new Blob([csvContent], { type: "text/csv" });
                const url = URL.createObjectURL(blob);
                const a = document.createElement("a");
                a.href = url;
                a.download = "datos_sensores.csv"; // Nombre del archivo
                a.click();

                // Limpia el objeto URL
                URL.revokeObjectURL(url);
            }

            // Función para actualizar el gráfico con los últimos datos
            async function updateAreaChartWithLatestData() {
                try {
                    const snapshot = await get(historialRef);
                    if (snapshot.exists()) {
                        const historial = snapshot.val();
                        const timestamps = [];
                        const temperatures = [];
                        const humidities = [];

                        // Obtener los últimos 10 registros
                        const entries = Object.entries(historial);
                        const lastTenEntries = entries.slice(-10);

                        lastTenEntries.forEach(([key, reading]) => {
                            timestamps.push(new Date(reading.timestamp).toLocaleTimeString());
                            temperatures.push(reading.PromT || 0);
                            humidities.push(reading.PromH || 0);
                        });

                        // Actualizar el gráfico
                        updateAreaChart(timestamps, temperatures, humidities);
                    }
                } catch (error) {
                    console.error('Error al actualizar el gráfico:', error);
                }
            }

            // Función para solicitar permiso de notificaciones
            async function requestNotificationPermission() {
                if (!("Notification" in window)) {
                    console.log("Este navegador no soporta notificaciones");
                    return;
                }

                if (Notification.permission !== "granted") {
                    await Notification.requestPermission();
                }
            }

            // Función para mostrar notificación y reproducir sonido
            function showNotification(title, message) {
                // Reproducir sonido
                const audio = document.getElementById('alertSound');
                audio.play().catch(e => console.log('Error reproduciendo sonido:', e));

                // Mostrar notificación del navegador
                if (Notification.permission === "granted") {
                    new Notification(title, {
                        body: message,
                        icon: 'assets/img/favicon-96x96.png'
                    });
                }
            }

            // Función para validar si un valor es válido
            function isValidValue(value) {
                return value !== null && 
                       value !== undefined && 
                       !isNaN(value) &&
                       value !== 0 && // En el código del ESP32, 0 se usa como indicador de error para algunos sensores
                       value !== -1;  // En el código del ESP32, -1 se usa como indicador de error para promedios
            }

            // Función para actualizar las notificaciones
            function updateNotifications(data) {
                const tempCard = document.getElementById('tempCard');
                const phCard = document.getElementById('phCard'); 
                const humCard = document.getElementById('humCard');
                const tempCardBody = document.getElementById('tempCardBody');
                const phCardBody = document.getElementById('phCardBody');
                const humCardBody = document.getElementById('humCardBody');

                // Verificar temperatura
                const temp = parseFloat(data.PromT);
                if (!isValidValue(temp)) {
                    tempCard.className = 'card bg-warning text-white mb-4';
                    tempCardBody.textContent = '⚠️ Error: Datos de temperatura inválidos';
                    showNotification('Error de Sensor', 
                        'Los datos de temperatura son inválidos o no están disponibles');
                } else if (temp < 20 || temp > 35) {
                    tempCard.className = 'card bg-danger text-white mb-4';
                    tempCardBody.textContent = `¡Alerta! Temperatura ${temp}°C fuera de rango (20-35°C)`;
                    showNotification('¡Alerta de Temperatura!', 
                        `La temperatura está en ${temp}°C (Rango ideal: 20-35°C)`);
                } else {
                    tempCard.className = 'card bg-success text-white mb-4';
                    tempCardBody.textContent = `Temperatura OK: ${temp}°C`;
                }

                // Verificar pH
                const ph = parseFloat(data.pH);
                if (!isValidValue(ph)) {
                    phCard.className = 'card bg-warning text-white mb-4';
                    phCardBody.textContent = '⚠️ Error: Datos de pH inválidos';
                    showNotification('Error de Sensor', 
                        'Los datos de pH son inválidos o no están disponibles');
                } else if (ph < 6.2 || ph > 7.8) {
                    phCard.className = 'card bg-danger text-white mb-4';
                    phCardBody.textContent = `¡Alerta! pH ${ph} fuera de rango (6.2-7.8)`;
                    showNotification('¡Alerta de pH!', 
                        `El pH está en ${ph} (Rango ideal: 6.2-7.8)`);
                } else {
                    phCard.className = 'card bg-success text-white mb-4';
                    phCardBody.textContent = `pH OK: ${ph}`;
                }

                // Verificar humedad
                const hum = parseFloat(data.PromH);
                if (!isValidValue(hum)) {
                    humCard.className = 'card bg-warning text-white mb-4';
                    humCardBody.textContent = '⚠️ Error: Datos de humedad inválidos';
                    showNotification('Error de Sensor', 
                        'Los datos de humedad son inválidos o no están disponibles');
                } else if (hum < 70) {
                    humCard.className = 'card bg-danger text-white mb-4';
                    humCardBody.textContent = `¡Alerta! Humedad ${hum}% debajo del 70%`;
                    showNotification('¡Alerta de Humedad!', 
                        `La humedad está en ${hum}% (Mínimo requerido: 70%)`);
                } else {
                    humCard.className = 'card bg-success text-white mb-4';
                    humCardBody.textContent = `Humedad OK: ${hum}%`;
                }
            }

            updateImages();
            setInterval(updateImages, 15000);

            // Mover estas declaraciones después de que el DOM esté listo
            document.addEventListener('DOMContentLoaded', () => {
                const button = document.getElementById('toggleCascada');
                
                // Escuchar el estado actual desde Firebase
                onValue(cascadaRef, (snapshot) => {
                    cascadaState = snapshot.val() || "OFF";
                    button.innerText = cascadaState === "ON" ? "Desactivar Cascada" : "Activar Cascada";
                });

                // Manejar el clic en el botón
                button.addEventListener('click', () => {
                    // Alternar el estado
                    const newState = cascadaState === "ON" ? "OFF" : "ON";

                    // Actualizar el estado en Firebase
                    set(cascadaRef, newState)
                        .then(() => {
                            console.log(`Estado de cascada cambiado a: ${newState}`);
                        })
                        .catch((error) => {
                            console.error("Error al actualizar el estado de cascada:", error);
                        });
                });

                // Agregar el código del botón CSV aquí
                document.getElementById("downloadCSV").addEventListener("click", async () => {
                    try {
                        const csvContent = await generateCSV();
                        const blob = new Blob([csvContent], { type: "text/csv" });
                        const url = URL.createObjectURL(blob);
                        const a = document.createElement("a");
                        a.href = url;
                        a.download = "historial_sensores.csv";
                        a.click();
                        URL.revokeObjectURL(url);
                    } catch (error) {
                        console.error("Error al generar CSV:", error);
                    }
                });
            });
          </script>
          <style>
            .sensor-data {
                display: flex;
                flex-wrap: wrap;
                gap: 20px;
            }
            .sensor-card {
                background-color: #f8f9fa;
                border: 1px solid #dee2e6;
                border-radius: 5px;
                padding: 20px;
                width: 200px;
                text-align: center;
            }
            .sensor-card h3 {
                margin-bottom: 10px;
            }
            .sensor-card p {
                font-size: 1.2em;
                margin: 0;
            }
            /* Estilos para las imágenes de las incubadoras */
            .card-body img {
                max-height: 300px;
                width: 100%;
                object-fit: cover;
                border-radius: 4px;
            }
            /* Asegurar que las tarjetas de imágenes tengan la misma altura */
            .card.mb-4 {
                height: 100%;
            }
        </style>

        <style>
            .btn-cascada {
                background-color: #007bff;
                color: white;
                border: none;
                padding: 10px 20px;
                font-size: 16px;
                border-radius: 5px;
                cursor: pointer;
                transition: background-color 0.3s ease;
            }
        
            .btn-cascada:hover {
                background-color: #0056b3;
            }
        
            .btn-cascada:active {
                background-color: #003f7f;
            }
        </style>
        <!-- Agregar el elemento de audio para la alerta -->
        <audio id="alertSound">
            <source src="assets/sounds/alert.mp3" type="audio/mp3">
        </audio>
    </head>
    <body class="sb-nav-fixed">
        <nav class="sb-topnav navbar navbar-expand navbar-dark bg-dark">
            <!-- Navbar Brand-->
            <a class="navbar-brand ps-3" href="index.html">Monitoreo</a>
            <!-- Sidebar Toggle-->
            <button class="btn btn-link btn-sm order-1 order-lg-0 me-4 me-lg-0"
                id="sidebarToggle" href="#!"><i
                    class="fas fa-bars"></i></button>
            <!-- Navbar Search-->
            <form
                class="d-none d-md-inline-block form-inline ms-auto me-0 me-md-3 my-2 my-md-0">
                <div class="input-group">
                    <input class="form-control" type="text"
                        placeholder="Search for..." aria-label="Search for..."
                        aria-describedby="btnNavbarSearch" />
                    <button class="btn btn-primary" id="btnNavbarSearch"
                        type="button"><i class="fas fa-search"></i></button>
                </div>
            </form>
            <!-- Navbar-->
            <ul class="navbar-nav ms-auto ms-md-0 me-3 me-lg-4">
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" id="navbarDropdown"
                        href="#" role="button" data-bs-toggle="dropdown"
                        aria-expanded="false"><i
                            class="fas fa-user fa-fw"></i></a>
                    <ul class="dropdown-menu dropdown-menu-end"
                        aria-labelledby="navbarDropdown">
                        <li><a class="dropdown-item" href="#!">Settings</a></li>
                        <li><a class="dropdown-item" href="#!">Activity
                                Log</a></li>
                        <li><hr class="dropdown-divider" /></li>
                        <li><a class="dropdown-item" href="#!">Logout</a></li>
                    </ul>
                </li>
            </ul>
        </nav>
        <div id="layoutSidenav">
            <div id="layoutSidenav_nav">
                <nav class="sb-sidenav accordion sb-sidenav-dark"
                    id="sidenavAccordion">
                    <div class="sb-sidenav-menu">
                        <div class="nav">
                            <div class="sb-sidenav-menu-heading">Core</div>
                            <a class="nav-link" href="index.html">
                                <div class="sb-nav-link-icon"><i
                                        class="fas fa-tachometer-alt"></i></div>
                                Dashboard
                            </a>
                            <div class="sb-sidenav-menu-heading">Interface</div>
                            <a class="nav-link collapsed" href="#"
                                data-bs-toggle="collapse"
                                data-bs-target="#collapseLayouts"
                                aria-expanded="false"
                                aria-controls="collapseLayouts">
                                <div class="sb-nav-link-icon"><i
                                        class="fas fa-columns"></i></div>
                                Layouts
                                <div class="sb-sidenav-collapse-arrow"><i
                                        class="fas fa-angle-down"></i></div>
                            </a>
                            <div class="collapse" id="collapseLayouts"
                                aria-labelledby="headingOne"
                                data-bs-parent="#sidenavAccordion">
                                <nav class="sb-sidenav-menu-nested nav">
                                    <a class="nav-link"
                                        href="layout-static.html">Static
                                        Navigation</a>
                                    <a class="nav-link"
                                        href="layout-sidenav-light.html">Light
                                        Sidenav</a>
                                </nav>
                            </div>
                            <a class="nav-link collapsed" href="#"
                                data-bs-toggle="collapse"
                                data-bs-target="#collapsePages"
                                aria-expanded="false"
                                aria-controls="collapsePages">
                                <div class="sb-nav-link-icon"><i
                                        class="fas fa-book-open"></i></div>
                                Pages
                                <div class="sb-sidenav-collapse-arrow"><i
                                        class="fas fa-angle-down"></i></div>
                            </a>
                            <div class="collapse" id="collapsePages"
                                aria-labelledby="headingTwo"
                                data-bs-parent="#sidenavAccordion">
                                <nav
                                    class="sb-sidenav-menu-nested nav accordion"
                                    id="sidenavAccordionPages">
                                    <a class="nav-link collapsed" href="#"
                                        data-bs-toggle="collapse"
                                        data-bs-target="#pagesCollapseAuth"
                                        aria-expanded="false"
                                        aria-controls="pagesCollapseAuth">
                                        Authentication
                                        <div
                                            class="sb-sidenav-collapse-arrow"><i
                                                class="fas fa-angle-down"></i></div>
                                    </a>
                                    <div class="collapse" id="pagesCollapseAuth"
                                        aria-labelledby="headingOne"
                                        data-bs-parent="#sidenavAccordionPages">
                                        <nav class="sb-sidenav-menu-nested nav">
                                            <a class="nav-link"
                                                href="login.html">Login</a>
                                            <a class="nav-link"
                                                href="register.html">Register</a>
                                            <a class="nav-link"
                                                href="password.html">Forgot
                                                Password</a>
                                        </nav>
                                    </div>
                                    <a class="nav-link collapsed" href="#"
                                        data-bs-toggle="collapse"
                                        data-bs-target="#pagesCollapseError"
                                        aria-expanded="false"
                                        aria-controls="pagesCollapseError">
                                        Error
                                        <div
                                            class="sb-sidenav-collapse-arrow"><i
                                                class="fas fa-angle-down"></i></div>
                                    </a>
                                    <div class="collapse"
                                        id="pagesCollapseError"
                                        aria-labelledby="headingOne"
                                        data-bs-parent="#sidenavAccordionPages">
                                        <nav class="sb-sidenav-menu-nested nav">
                                            <a class="nav-link"
                                                href="401.html">401 Page</a>
                                            <a class="nav-link"
                                                href="404.html">404 Page</a>
                                            <a class="nav-link"
                                                href="500.html">500 Page</a>
                                        </nav>
                                    </div>
                                </nav>
                            </div>
                            <div class="sb-sidenav-menu-heading">Addons</div>
                            <a class="nav-link" href="charts.html">
                                <div class="sb-nav-link-icon"><i
                                        class="fas fa-chart-area"></i></div>
                                Charts
                            </a>
                            <a class="nav-link" href="tables.html">
                                <div class="sb-nav-link-icon"><i
                                        class="fas fa-table"></i></div>
                                Tables
                            </a>
                        </div>
                    </div>
                    <div class="sb-sidenav-footer">
                        <div class="small">Logged in as:</div>
                        Start Bootstrap
                    </div>
                </nav>
            </div>
            <div id="layoutSidenav_content">
                <main>
                    <div class="container-fluid px-4">

                        <h1 class="mt-4">Dashboard</h1>
                        <ol class="breadcrumb mb-4">
                            <li class="breadcrumb-item active">Dashboard</li>
                        </ol>
                        
                        <!-- Sección de Cámaras en línea horizontal -->
                        <div class="row mt-4 mb-5">
                            <!-- Incubadora 1 -->
                            <div class="col-lg-4 mb-4">
                                <div class="card h-100">
                                    <div class="card-header">
                                        <i class="fas fa-camera me-1"></i> Vista de la Incubadora 1 "CONTROL"
                                    </div>
                                    <div class="card-body text-center p-3">
                                        <img src="" alt="Ultima foto tomada de la incubadora 1" id="Incubadora_1" class="img-fluid">
                                    </div>
                                </div>
                            </div>

                            <!-- Incubadora 2 -->
                            <div class="col-lg-4 mb-4">
                                <div class="card h-100">
                                    <div class="card-header">
                                        <i class="fas fa-camera me-1"></i> Vista de la Incubadora 2
                                    </div>
                                    <div class="card-body text-center p-3">
                                        <img src="" alt="Ultima foto tomada de la incubadora 2" id="Incubadora_2" class="img-fluid">
                                    </div>
                                </div>
                            </div>

                            <!-- Incubadora 3 -->
                            <div class="col-lg-4 mb-4">
                                <div class="card h-100">
                                    <div class="card-header">
                                        <i class="fas fa-camera me-1"></i> Vista de la Incubadora 3
                                    </div>
                                    <div class="card-body text-center p-3">
                                        <img src="" alt="Ultima foto tomada de la incubadora 3" id="Incubadora_3" class="img-fluid">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <hr class="mt-4 mb-5">

                        <!-- Sección de Datos del Sensor Incubadora 1 -->
                        <h1>Datos Incubadora 1 (Control)</h1>
                        <div class="sensor-data">
                            <div class="sensor-card">
                                <h3>DS18</h3>
                                <p id="DS18">0</p>
                            </div>
                            <div class="sensor-card">
                                <h3>Temp1</h3>
                                <p id="Temp1">0</p>
                            </div>
                            <div class="sensor-card">
                                <h3>Temp2</h3>
                                <p id="Temp2">0</p>
                            </div>
                            <div class="sensor-card">
                                <h3>Temp3</h3>
                                <p id="Temp3">0</p>
                            </div>
                            <div class="sensor-card">
                                <h3>Hum1</h3>
                                <p id="Hum1">0</p>
                            </div>
                            <div class="sensor-card">
                                <h3>Hum2</h3>
                                <p id="Hum2">0</p>
                            </div>
                            <div class="sensor-card">
                                <h3>Hum3</h3>
                                <p id="Hum3">0</p>
                            </div>
                            <div class="sensor-card">
                                <h3>PromT</h3>
                                <p id="PromT">0</p>
                            </div>
                            <div class="sensor-card">
                                <h3>PromH</h3>
                                <p id="PromH">0</p>
                            </div>
                            <div class="sensor-card">
                                <h3>pH</h3>
                                <p id="pH">0</p>
                            </div>
                            <div class="sensor-card">
                                <button id="toggleCascada" class="btn-cascada">Activar Cascada</button>
                            </div>
                            <div class="sensor-card">
                                <button id="downloadCSV" class="btn-cascada">Descargar CSV</button>
                            </div>
                        </div>

                        <!-- Sección de Datos del Sensor Incubadora 2 -->
                        <h1 class="mt-5">Datos Incubadora 2</h1>
                        <div class="sensor-data">
                            <div class="sensor-card">
                                <h3>DS18</h3>
                                <p id="DS18_2">0</p>
                            </div>
                            <div class="sensor-card">
                                <h3>Temp1</h3>
                                <p id="Temp1_2">0</p>
                            </div>
                            <div class="sensor-card">
                                <h3>Temp2</h3>
                                <p id="Temp2_2">0</p>
                            </div>
                            <div class="sensor-card">
                                <h3>Temp3</h3>
                                <p id="Temp3_2">0</p>
                            </div>
                            <div class="sensor-card">
                                <h3>Hum1</h3>
                                <p id="Hum1_2">0</p>
                            </div>
                            <div class="sensor-card">
                                <h3>Hum2</h3>
                                <p id="Hum2_2">0</p>
                            </div>
                            <div class="sensor-card">
                                <h3>Hum3</h3>
                                <p id="Hum3_2">0</p>
                            </div>
                            <div class="sensor-card">
                                <h3>PromT</h3>
                                <p id="PromT_2">0</p>
                            </div>
                            <div class="sensor-card">
                                <h3>PromH</h3>
                                <p id="PromH_2">0</p>
                            </div>
                        </div>

                        <!-- Sección de Datos del Sensor Incubadora 3 -->
                        <h1 class="mt-5">Datos Incubadora 3</h1>
                        <div class="sensor-data mb-5">
                            <div class="sensor-card">
                                <h3>DS18</h3>
                                <p id="DS18_3">0</p>
                            </div>
                            <div class="sensor-card">
                                <h3>Temp1</h3>
                                <p id="Temp1_3">0</p>
                            </div>
                            <div class="sensor-card">
                                <h3>Temp2</h3>
                                <p id="Temp2_3">0</p>
                            </div>
                            <div class="sensor-card">
                                <h3>Temp3</h3>
                                <p id="Temp3_3">0</p>
                            </div>
                            <div class="sensor-card">
                                <h3>Hum1</h3>
                                <p id="Hum1_3">0</p>
                            </div>
                            <div class="sensor-card">
                                <h3>Hum2</h3>
                                <p id="Hum2_3">0</p>
                            </div>
                            <div class="sensor-card">
                                <h3>Hum3</h3>
                                <p id="Hum3_3">0</p>
                            </div>
                            <div class="sensor-card">
                                <h3>PromT</h3>
                                <p id="PromT_3">0</p>
                            </div>
                            <div class="sensor-card">
                                <h3>PromH</h3>
                                <p id="PromH_3">0</p>
                            </div>
                        </div>

                        <!-- Cards de notificación -->
                        <div class="row mb-4">
                            <div class="col-xl-3 col-md-6">
                                <div id="tempCard" class="card bg-success text-white mb-4">
                                    <div id="tempCardBody" class="card-body">Estado de Temperatura</div>
                                    <div class="card-footer d-flex align-items-center justify-content-between">
                                        <div class="small text-white">Rango ideal: 20-35°C</div>
                                        <div class="small text-white"><i class="fas fa-thermometer-half"></i></div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-3 col-md-6">
                                <div id="phCard" class="card bg-success text-white mb-4">
                                    <div id="phCardBody" class="card-body">Estado del pH</div>
                                    <div class="card-footer d-flex align-items-center justify-content-between">
                                        <div class="small text-white">Rango ideal: 6.2-7.8</div>
                                        <div class="small text-white"><i class="fas fa-flask"></i></div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-3 col-md-6">
                                <div id="humCard" class="card bg-success text-white mb-4">
                                    <div id="humCardBody" class="card-body">Estado de Humedad</div>
                                    <div class="card-footer d-flex align-items-center justify-content-between">
                                        <div class="small text-white">Mínimo requerido: 70%</div>
                                        <div class="small text-white"><i class="fas fa-tint"></i></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Espaciado entre tarjetas y gráfica -->
                        <div class="my-4"></div>
                        <div class="row">
                            <div class="col-xl-6">
                                <div class="card mb-4">
                                    <div class="card-header">
                                        <i class="fas fa-chart-area me-1"></i>
                                        Area Chart Example
                                    </div>
                                    <div class="card-body"><canvas
                                            id="myAreaChart" width="100%"
                                            height="40"></canvas></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </main>
                <footer class="py-4 bg-light mt-auto">
                    <div class="container-fluid px-4">
                        <div
                            class="d-flex align-items-center justify-content-between small">
                            <div class="text-muted">Copyright &copy; 2025</div>
                            <div>
                                <!--
                                <a href="#">Privacy Policy</a>
                                &middot;
                                <a href="#">Terms &amp; Conditions</a>
                                -->
                            </div>
                        </div>
                    </div>
                </footer>
            </div>
        </div>
        <script
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
            crossorigin="anonymous"></script>
        <script src="js/scripts.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js" crossorigin="anonymous"></script>
        <script src="assets/demo/chart-area-demo.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/simple-datatables@7.1.2/dist/umd/simple-datatables.min.js" crossorigin="anonymous"></script>
        <script src="js/datatables-simple-demo.js"></script>
    </body>
</html>
